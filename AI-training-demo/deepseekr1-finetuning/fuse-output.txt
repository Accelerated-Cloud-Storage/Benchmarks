(.venv) [ec2-user@ip-172-31-25-0 deepseekr1-finetuning]$ python train.py     --output_dir /mnt/acs-bucket/hf22Out  --dataset_name wikitext     --dataset_c
onfig wikitext-2-v1     --max_train_samples 1000
2025-04-25 03:55:52,739 - datasets - INFO - PyTorch version 2.6.0 available.
Detected accelerate version: 1.6.0
Detected datasets version: 3.5.0
Detected jinja2 version: 3.1.5
Detected pandas version: 2.2.3
Detected psutil version: 7.0.0
Detected pytest version: 8.3.5
Detected safetensors version: 0.5.3
Detected tokenizers version: 0.21.1
Detected triton version: 3.2.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0
Detected torch version: 2.6.0

=== Starting Training Pipeline ===

Step 1: Loading tokenizer and model...
Request 2f28c33a-bccf-491f-b151-ac585dea1052: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/tokenizer_config.json (authenticated: False)
2025-04-25 03:55:57,093 - huggingface_hub.utils._http - DEBUG - Request 2f28c33a-bccf-491f-b151-ac585dea1052: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/tokenizer_config.json (authenticated: False)
2025-04-25 03:55:57,093 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-04-25 03:55:57,113 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
loading file tokenizer.model from cache at None
loading file tokenizer.json from cache at /home/ec2-user/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-R1-Distill-Qwen-1.5B/snapshots/ad9f0ae0864d7fbcd1cd905e3c6c5b069cc8b562/tokenizer.json
loading file added_tokens.json from cache at None
loading file special_tokens_map.json from cache at None
loading file tokenizer_config.json from cache at /home/ec2-user/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-R1-Distill-Qwen-1.5B/snapshots/ad9f0ae0864d7fbcd1cd905e3c6c5b069cc8b562/tokenizer_config.json
loading file chat_template.jinja from cache at None
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Request df21a240-361b-4ba7-a354-4fdc181bdec7: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/config.json (authenticated: False)
2025-04-25 03:55:57,463 - huggingface_hub.utils._http - DEBUG - Request df21a240-361b-4ba7-a354-4fdc181bdec7: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/config.json (authenticated: False)
2025-04-25 03:55:57,475 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/config.json HTTP/1.1" 200 0
loading configuration file config.json from cache at /home/ec2-user/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-R1-Distill-Qwen-1.5B/snapshots/ad9f0ae0864d7fbcd1cd905e3c6c5b069cc8b562/config.json
Model config Qwen2Config {
  "architectures": [
    "Qwen2ForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151643,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 131072,
  "max_window_layers": 21,
  "model_type": "qwen2",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 10000,
  "sliding_window": 4096,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.51.2",
  "use_cache": true,
  "use_mrope": false,
  "use_sliding_window": false,
  "vocab_size": 151936
}

loading weights file model.safetensors from cache at /home/ec2-user/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-R1-Distill-Qwen-1.5B/snapshots/ad9f0ae0864d7fbcd1cd905e3c6c5b069cc8b562/model.safetensors
Generate config GenerationConfig {
  "bos_token_id": 151643,
  "eos_token_id": 151643
}

Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
All model checkpoint weights were used when initializing Qwen2ForCausalLM.

All the weights of Qwen2ForCausalLM were initialized from the model checkpoint at deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use Qwen2ForCausalLM for predictions without further training.
Request 6904b37b-3645-4311-a82f-87b20dd66291: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/generation_config.json (authenticated: False)
2025-04-25 03:56:03,634 - huggingface_hub.utils._http - DEBUG - Request 6904b37b-3645-4311-a82f-87b20dd66291: HEAD https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/generation_config.json (authenticated: False)
2025-04-25 03:56:03,643 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/resolve/main/generation_config.json HTTP/1.1" 200 0
loading configuration file generation_config.json from cache at /home/ec2-user/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-R1-Distill-Qwen-1.5B/snapshots/ad9f0ae0864d7fbcd1cd905e3c6c5b069cc8b562/generation_config.json
Generate config GenerationConfig {
  "bos_token_id": 151646,
  "do_sample": true,
  "eos_token_id": 151643,
  "temperature": 0.6,
  "top_p": 0.95
}

Time taken: 6.55 seconds

Step 2: Loading dataset...
Loading dataset from Hugging Face Hub: wikitext
Request 1af3155f-31cf-4975-a2d9-65f68eb38458: HEAD https://huggingface.co/datasets/wikitext/resolve/main/README.md (authenticated: False)
2025-04-25 03:56:03,647 - huggingface_hub.utils._http - DEBUG - Request 1af3155f-31cf-4975-a2d9-65f68eb38458: HEAD https://huggingface.co/datasets/wikitext/resolve/main/README.md (authenticated: False)
2025-04-25 03:56:03,658 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/wikitext/resolve/main/README.md HTTP/1.1" 307 0
Request 8f2d97a5-94e4-446b-92d6-eb71f5067f48: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/main/README.md (authenticated: False)
2025-04-25 03:56:03,660 - huggingface_hub.utils._http - DEBUG - Request 8f2d97a5-94e4-446b-92d6-eb71f5067f48: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/main/README.md (authenticated: False)
2025-04-25 03:56:03,674 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/Salesforce/wikitext/resolve/main/README.md HTTP/1.1" 200 0
Request 988eca67-ce2f-41c0-af90-0e9f9fc4b5a1: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py (authenticated: False)
2025-04-25 03:56:03,676 - huggingface_hub.utils._http - DEBUG - Request 988eca67-ce2f-41c0-af90-0e9f9fc4b5a1: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py (authenticated: False)
2025-04-25 03:56:03,688 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py HTTP/1.1" 307 0
Request 784ee425-dea4-4342-ab33-517dbfb276fb: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py (authenticated: False)
2025-04-25 03:56:03,689 - huggingface_hub.utils._http - DEBUG - Request 784ee425-dea4-4342-ab33-517dbfb276fb: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py (authenticated: False)
2025-04-25 03:56:03,710 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext.py HTTP/1.1" 404 0
Request 5c81c5b8-06e0-40f8-96c2-a24e19b09563: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/wikitext/wikitext.py (authenticated: False)
2025-04-25 03:56:03,711 - huggingface_hub.utils._http - DEBUG - Request 5c81c5b8-06e0-40f8-96c2-a24e19b09563: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/wikitext/wikitext.py (authenticated: False)
2025-04-25 03:56:03,711 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): s3.amazonaws.com:443
2025-04-25 03:56:03,744 - urllib3.connectionpool - DEBUG - https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/wikitext/wikitext.py HTTP/1.1" 200 0
Request 1726e166-4d4a-4f43-8f14-6a4458dc0e36: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,755 - huggingface_hub.utils._http - DEBUG - Request 1726e166-4d4a-4f43-8f14-6a4458dc0e36: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,767 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 118
Request 1726e166-4d4a-4f43-8f14-6a4458dc0e36: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,768 - huggingface_hub.utils._http - DEBUG - Request 1726e166-4d4a-4f43-8f14-6a4458dc0e36: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,780 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 5016
Request 4ae6800c-6696-4d2e-bbe2-ca45349373ae: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml (authenticated: False)
2025-04-25 03:56:03,781 - huggingface_hub.utils._http - DEBUG - Request 4ae6800c-6696-4d2e-bbe2-ca45349373ae: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml (authenticated: False)
2025-04-25 03:56:03,796 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml HTTP/1.1" 307 0
Request 99b2cd85-ba5b-4aeb-b335-f5314c708e3b: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml (authenticated: False)
2025-04-25 03:56:03,798 - huggingface_hub.utils._http - DEBUG - Request 99b2cd85-ba5b-4aeb-b335-f5314c708e3b: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml (authenticated: False)
2025-04-25 03:56:03,809 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/.huggingface.yaml HTTP/1.1" 404 0
Request 42093a6d-5d01-4227-8f53-6cc34c9e0479: GET https://datasets-server.huggingface.co/info?dataset=wikitext (authenticated: False)
2025-04-25 03:56:03,811 - huggingface_hub.utils._http - DEBUG - Request 42093a6d-5d01-4227-8f53-6cc34c9e0479: GET https://datasets-server.huggingface.co/info?dataset=wikitext (authenticated: False)
2025-04-25 03:56:03,811 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): datasets-server.huggingface.co:443
2025-04-25 03:56:03,863 - urllib3.connectionpool - DEBUG - https://datasets-server.huggingface.co:443 "GET /info?dataset=wikitext HTTP/1.1" 404 None
Request ee3db30a-e345-4ed2-a318-e2177f1043b7: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,869 - huggingface_hub.utils._http - DEBUG - Request ee3db30a-e345-4ed2-a318-e2177f1043b7: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,880 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 118
Request ee3db30a-e345-4ed2-a318-e2177f1043b7: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,881 - huggingface_hub.utils._http - DEBUG - Request ee3db30a-e345-4ed2-a318-e2177f1043b7: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,893 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 5016
Request fd3a0b57-117c-4139-bbd8-8f78a95e999d: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:03,895 - huggingface_hub.utils._http - DEBUG - Request fd3a0b57-117c-4139-bbd8-8f78a95e999d: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:03,943 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False HTTP/1.1" 307 143
Request fd3a0b57-117c-4139-bbd8-8f78a95e999d: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:03,944 - huggingface_hub.utils._http - DEBUG - Request fd3a0b57-117c-4139-bbd8-8f78a95e999d: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:03,958 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3?recursive=False&expand=False HTTP/1.1" 200 619
Request 4a32490b-27ab-47f7-a328-97608cc37741: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,959 - huggingface_hub.utils._http - DEBUG - Request 4a32490b-27ab-47f7-a328-97608cc37741: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,970 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request 4a32490b-27ab-47f7-a328-97608cc37741: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:03,971 - huggingface_hub.utils._http - DEBUG - Request 4a32490b-27ab-47f7-a328-97608cc37741: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,057 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 250
Request bf2a0a47-17f1-4d4c-bf58-d48398c24022: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,058 - huggingface_hub.utils._http - DEBUG - Request bf2a0a47-17f1-4d4c-bf58-d48398c24022: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,073 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False HTTP/1.1" 307 163
Request bf2a0a47-17f1-4d4c-bf58-d48398c24022: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,074 - huggingface_hub.utils._http - DEBUG - Request bf2a0a47-17f1-4d4c-bf58-d48398c24022: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,091 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-103-raw-v1?recursive=False&expand=False HTTP/1.1" 200 1017
Request d9a31a1f-c60e-4c90-9990-5725d417b484: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,096 - huggingface_hub.utils._http - DEBUG - Request d9a31a1f-c60e-4c90-9990-5725d417b484: GET https://huggingface.co/api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,096 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-04-25 03:56:04,116 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 118
Request d9a31a1f-c60e-4c90-9990-5725d417b484: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,117 - huggingface_hub.utils._http - DEBUG - Request d9a31a1f-c60e-4c90-9990-5725d417b484: GET https://huggingface.co/api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,131 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/revision/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 5016
Request 1b793b6d-79b8-4799-8776-9b700e7c7068: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,132 - huggingface_hub.utils._http - DEBUG - Request 1b793b6d-79b8-4799-8776-9b700e7c7068: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,171 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request 1b793b6d-79b8-4799-8776-9b700e7c7068: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,172 - huggingface_hub.utils._http - DEBUG - Request 1b793b6d-79b8-4799-8776-9b700e7c7068: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,201 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 250
Request 3de10e19-deda-46d4-ab32-8f3e6d0e8c55: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,204 - huggingface_hub.utils._http - DEBUG - Request 3de10e19-deda-46d4-ab32-8f3e6d0e8c55: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,217 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request 3de10e19-deda-46d4-ab32-8f3e6d0e8c55: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,218 - huggingface_hub.utils._http - DEBUG - Request 3de10e19-deda-46d4-ab32-8f3e6d0e8c55: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,237 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 250
Request de714419-cdaf-40a9-94f2-5948bb139418: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json (authenticated: False)
2025-04-25 03:56:04,241 - huggingface_hub.utils._http - DEBUG - Request de714419-cdaf-40a9-94f2-5948bb139418: HEAD https://huggingface.co/datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json (authenticated: False)
2025-04-25 03:56:04,253 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json HTTP/1.1" 307 0
Request 59d793e0-4dfb-4004-bfeb-a0cf0bb72b35: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json (authenticated: False)
2025-04-25 03:56:04,255 - huggingface_hub.utils._http - DEBUG - Request 59d793e0-4dfb-4004-bfeb-a0cf0bb72b35: HEAD https://huggingface.co/datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json (authenticated: False)
2025-04-25 03:56:04,276 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/Salesforce/wikitext/resolve/b08601e04326c79dfdd32d625aee71d232d685c3/dataset_infos.json HTTP/1.1" 404 0
Request c554399f-fc8b-4531-a049-9e7edb10d783: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,278 - huggingface_hub.utils._http - DEBUG - Request c554399f-fc8b-4531-a049-9e7edb10d783: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,290 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request c554399f-fc8b-4531-a049-9e7edb10d783: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,291 - huggingface_hub.utils._http - DEBUG - Request c554399f-fc8b-4531-a049-9e7edb10d783: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,315 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 244
Request 21a78d88-4276-4f29-bf7a-34f72b2ec59f: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,317 - huggingface_hub.utils._http - DEBUG - Request 21a78d88-4276-4f29-bf7a-34f72b2ec59f: GET https://huggingface.co/api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,329 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False HTTP/1.1" 307 157
Request 21a78d88-4276-4f29-bf7a-34f72b2ec59f: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,330 - huggingface_hub.utils._http - DEBUG - Request 21a78d88-4276-4f29-bf7a-34f72b2ec59f: GET https://huggingface.co/api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False (authenticated: False)
2025-04-25 03:56:04,345 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/Salesforce/wikitext/tree/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-v1?recursive=False&expand=False HTTP/1.1" 200 739
Request cebe1237-711e-4f83-9dd8-1f306d3102c5: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,348 - huggingface_hub.utils._http - DEBUG - Request cebe1237-711e-4f83-9dd8-1f306d3102c5: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,360 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request cebe1237-711e-4f83-9dd8-1f306d3102c5: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,361 - huggingface_hub.utils._http - DEBUG - Request cebe1237-711e-4f83-9dd8-1f306d3102c5: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,385 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 244
Request 547f954b-7763-4077-a39e-6c0cbaeaa0ff: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,387 - huggingface_hub.utils._http - DEBUG - Request 547f954b-7763-4077-a39e-6c0cbaeaa0ff: POST https://huggingface.co/api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,404 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 307 120
Request 547f954b-7763-4077-a39e-6c0cbaeaa0ff: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,405 - huggingface_hub.utils._http - DEBUG - Request 547f954b-7763-4077-a39e-6c0cbaeaa0ff: POST https://huggingface.co/api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 (authenticated: False)
2025-04-25 03:56:04,424 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "POST /api/datasets/Salesforce/wikitext/paths-info/b08601e04326c79dfdd32d625aee71d232d685c3 HTTP/1.1" 200 244
2025-04-25 03:56:04,426 - filelock - DEBUG - Attempting to acquire lock 140110279403840 on /home/ec2-user/.cache/huggingface/datasets/_home_ec2-user_.cache_huggingface_datasets_wikitext_wikitext-2-v1_0.0.0_b08601e04326c79dfdd32d625aee71d232d685c3.lock
2025-04-25 03:56:04,427 - filelock - DEBUG - Lock 140110279403840 acquired on /home/ec2-user/.cache/huggingface/datasets/_home_ec2-user_.cache_huggingface_datasets_wikitext_wikitext-2-v1_0.0.0_b08601e04326c79dfdd32d625aee71d232d685c3.lock
2025-04-25 03:56:04,427 - filelock - DEBUG - Attempting to release lock 140110279403840 on /home/ec2-user/.cache/huggingface/datasets/_home_ec2-user_.cache_huggingface_datasets_wikitext_wikitext-2-v1_0.0.0_b08601e04326c79dfdd32d625aee71d232d685c3.lock
2025-04-25 03:56:04,427 - filelock - DEBUG - Lock 140110279403840 released on /home/ec2-user/.cache/huggingface/datasets/_home_ec2-user_.cache_huggingface_datasets_wikitext_wikitext-2-v1_0.0.0_b08601e04326c79dfdd32d625aee71d232d685c3.lock
2025-04-25 03:56:04,432 - filelock - DEBUG - Attempting to acquire lock 140110277672864 on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3_builder.lock
2025-04-25 03:56:04,433 - filelock - DEBUG - Lock 140110277672864 acquired on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3_builder.lock
Generating test split:   0%|                                                                                              | 0/4358 [00:00<?, ? examples/s]2025-04-25 03:56:04,446 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete/wikitext-test-00000-00000-of-NNNNN.arrow
Generating test split: 100%|████████████████████████████████████████████████████████████████████████████████| 4358/4358 [00:00<00:00, 74904.42 examples/s]
Generating train split:   0%|                                                                                            | 0/36718 [00:00<?, ? examples/s]2025-04-25 03:56:04,504 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete/wikitext-train-00000-00000-of-NNNNN.arrow
Generating train split: 100%|████████████████████████████████████████████████████████████████████████████| 36718/36718 [00:00<00:00, 690742.00 examples/s]
Generating validation split:   0%|                                                                                        | 0/3760 [00:00<?, ? examples/s]2025-04-25 03:56:04,558 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete/wikitext-validation-00000-00000-of-NNNNN.arrow
Generating validation split: 100%|█████████████████████████████████████████████████████████████████████████| 3760/3760 [00:00<00:00, 487498.70 examples/s]
2025-04-25 03:56:04,566 - filelock - DEBUG - Attempting to acquire lock 140110277189984 on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete_info.lock
2025-04-25 03:56:04,567 - filelock - DEBUG - Lock 140110277189984 acquired on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete_info.lock
2025-04-25 03:56:04,568 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete/dataset_info.json
2025-04-25 03:56:04,568 - filelock - DEBUG - Attempting to release lock 140110277189984 on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete_info.lock
2025-04-25 03:56:04,569 - filelock - DEBUG - Lock 140110277189984 released on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3.incomplete_info.lock
2025-04-25 03:56:04,569 - filelock - DEBUG - Attempting to release lock 140110277672864 on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3_builder.lock
2025-04-25 03:56:04,569 - filelock - DEBUG - Lock 140110277672864 released on /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3_builder.lock
Time taken: 0.93 seconds

Step 3: Tokenizing dataset...
Parameter 'function'=<function main.<locals>.tokenize_function at 0x7f6df76e4e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
2025-04-25 03:56:04,577 - datasets.fingerprint - WARNING - Parameter 'function'=<function main.<locals>.tokenize_function at 0x7f6df76e4e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
Map:   0%|                                                                                                                | 0/4358 [00:00<?, ? examples/s]2025-04-25 03:56:04,626 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp9w_xj455
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 4358/4358 [00:00<00:00, 22649.27 examples/s]
Map:   0%|                                                                                                               | 0/36718 [00:00<?, ? examples/s]2025-04-25 03:56:04,796 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp2yaqzwes
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 36718/36718 [00:01<00:00, 23025.96 examples/s]
Map:   0%|                                                                                                                | 0/3760 [00:00<?, ? examples/s]2025-04-25 03:56:06,390 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp9ymycx4b
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 3760/3760 [00:00<00:00, 25938.80 examples/s]
Time taken: 1.94 seconds

Step 4: Grouping text into blocks...
Map:   0%|                                                                                                                | 0/4358 [00:00<?, ? examples/s]2025-04-25 03:56:06,673 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpfhyyowtr
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 4358/4358 [00:00<00:00, 6667.15 examples/s]
Map:   0%|                                                                                                                | 0/1000 [00:00<?, ? examples/s]2025-04-25 03:56:07,301 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpr1a_3xup
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 7163.10 examples/s]
Map:   0%|                                                                                                                | 0/3760 [00:00<?, ? examples/s]2025-04-25 03:56:07,442 - fsspec.local - DEBUG - open file: /home/ec2-user/.cache/huggingface/datasets/wikitext/wikitext-2-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpos4o0r7e
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 3760/3760 [00:00<00:00, 6569.47 examples/s]
Time taken: 1.37 seconds

Step 5: Setting up data collator...
Time taken: 0.00 seconds

Step 6: Setting up training arguments...
PyTorch: setting up devices
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
        - Avoid using `tokenizers` before the fork if possible
        - Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/home/ec2-user/Benchmarks/AI-training-demo/deepseekr1-finetuning/train.py:209: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Time taken: 1.82 seconds

Step 7: Starting training...
Currently training with a batch size of: 2
***** Running training *****
  Num examples = 65
  Num Epochs = 1
  Instantaneous batch size per device = 2
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 4
  Total optimization steps = 8
  Number of trainable parameters = 1,777,088,000
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:22<00:00,  2.79s/it]Saving model checkpoint to /mnt/acs-bucket/hf22Out/checkpoint-8
Configuration saved in /mnt/acs-bucket/hf22Out/checkpoint-8/config.json
Configuration saved in /mnt/acs-bucket/hf22Out/checkpoint-8/generation_config.json
The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 2 checkpoint shards. You can find where each parameters has been saved in the index located at /mnt/acs-bucket/hf22Out/checkpoint-8/model.safetensors.index.json.
tokenizer config file saved in /mnt/acs-bucket/hf22Out/checkpoint-8/tokenizer_config.json
Special tokens file saved in /mnt/acs-bucket/hf22Out/checkpoint-8/special_tokens_map.json


Training completed. Do not forget to share your model on huggingface.co/models =)


{'train_runtime': 151.6911, 'train_samples_per_second': 0.429, 'train_steps_per_second': 0.053, 'train_loss': 3.1208393573760986, 'epoch': 0.97}          
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [02:31<00:00, 18.96s/it]
Training time: 151.82 seconds

Step 8: Saving final model...
Saving model checkpoint to /mnt/acs-bucket/hf22Out
Configuration saved in /mnt/acs-bucket/hf22Out/config.json
Configuration saved in /mnt/acs-bucket/hf22Out/generation_config.json
The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 2 checkpoint shards. You can find where each parameters has been saved in the index located at /mnt/acs-bucket/hf22Out/model.safetensors.index.json.
tokenizer config file saved in /mnt/acs-bucket/hf22Out/tokenizer_config.json
Special tokens file saved in /mnt/acs-bucket/hf22Out/special_tokens_map.json
tokenizer config file saved in /mnt/acs-bucket/hf22Out/tokenizer_config.json
Special tokens file saved in /mnt/acs-bucket/hf22Out/special_tokens_map.json
Time taken: 39.62 seconds

=== Training Pipeline Completed ===
Total time taken: 204.06 seconds (0.06 hours)
Training time: 151.82 seconds (0.04 hours)